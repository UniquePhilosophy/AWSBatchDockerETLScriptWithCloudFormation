üöÄ Starting full teardown of all project infrastructure...
--------------------------------------------------------
üî• Deleting stack iac-phase2...
‚ö†Ô∏è  Stack iac-phase2 deletion failed. Checking for root cause...
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|                                                                                                                                                                                                                      DescribeStackEvents                                                                                                                                                                                                                      |
+-------------------+-----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| LogicalResourceId |        ResourceType         |                                                                                                                                                                                                StatusReason                                                                                                                                                                                                 |
+-------------------+-----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|  iac-phase2       |  AWS::CloudFormation::Stack |  The following resource(s) failed to delete: [ETLRepository].                                                                                                                                                                                                                                                                                                                                               |
|  ETLRepository    |  AWS::ECR::Repository       |  Resource handler returned message: "The repository with name 'iac-etl-repo-jr' in registry with id '377983122567' cannot be deleted because it still contains images (Service: Ecr, Status Code: 400, Request ID: 64c3057f-7d76-40e8-93ff-2be8583c9334) (SDK Attempt Count: 1)" (RequestToken: e94e19cb-b771-baa3-c409-f703a6400300, HandlerErrorCode: GeneralServiceException)                            |
|  iac-phase2       |  AWS::CloudFormation::Stack |  The following resource(s) failed to delete: [ETLRepository].                                                                                                                                                                                                                                                                                                                                               |
|  ETLRepository    |  AWS::ECR::Repository       |  Resource handler returned message: "The repository with name 'iac-etl-repo-jr' in registry with id '377983122567' cannot be deleted because it still contains images (Service: Ecr, Status Code: 400, Request ID: 2d65a153-be1f-4312-9410-91007e6f53a9) (SDK Attempt Count: 1)" (RequestToken: c43a5d60-99ea-ce5a-2c8e-3941a8cac0d2, HandlerErrorCode: GeneralServiceException)                            |
|  iac-phase2       |  AWS::CloudFormation::Stack |  The following resource(s) failed to delete: [LogsBucket, ETLRepository].                                                                                                                                                                                                                                                                                                                                   |
|  LogsBucket       |  AWS::S3::Bucket            |  Resource handler returned message: "The bucket you tried to delete is not empty (Service: S3, Status Code: 409, Request ID: QRPHNMT0Q8MT2N54, Extended Request ID: ZKrPEZR3hkIC7kp1yfBU9seOLNOkFZbtvjoNojt9eDkONDDif6VUhqm69IRBljzlPXbjb7kTQLEEJKlfYyN9smDjeNubED3CuG9vs85/cK4=) (SDK Attempt Count: 1)" (RequestToken: e92a35c9-fafd-3b52-40da-709282a31369, HandlerErrorCode: GeneralServiceException)   |
|  ETLRepository    |  AWS::ECR::Repository       |  Resource handler returned message: "The repository with name 'iac-etl-repo-jr' in registry with id '377983122567' cannot be deleted because it still contains images (Service: Ecr, Status Code: 400, Request ID: 483a2273-d8db-41d6-af2b-cd579e20714b) (SDK Attempt Count: 1)" (RequestToken: 7f226f28-534e-d669-e84f-de6c5b90db71, HandlerErrorCode: GeneralServiceException)                            |
|  iac-phase2       |  AWS::CloudFormation::Stack |  The following resource(s) failed to delete: [LogsBucket, ETLRepository].                                                                                                                                                                                                                                                                                                                                   |
|  LogsBucket       |  AWS::S3::Bucket            |  Resource handler returned message: "The bucket you tried to delete is not empty (Service: S3, Status Code: 409, Request ID: YACW1TB6S748EGV2, Extended Request ID: Hn6WuBiE2h/nz/DB6lbokpmzSFh2TQ7BKrDQy+jfGFVedePyKRVisHjaiX4kt//S/BLxEY7LivA=) (SDK Attempt Count: 1)" (RequestToken: 0ba6f308-4bcc-d352-c869-b730c1ef5502, HandlerErrorCode: GeneralServiceException)                                   |
|  ETLRepository    |  AWS::ECR::Repository       |  Resource handler returned message: "The repository with name 'iac-etl-repo-jr' in registry with id '377983122567' cannot be deleted because it still contains images (Service: Ecr, Status Code: 400, Request ID: 4940d544-e8fb-446e-9dcf-ab6b8a8a5221) (SDK Attempt Count: 1)" (RequestToken: 034379d0-756c-c1fb-7b7f-9fe3fcbbcce2, HandlerErrorCode: GeneralServiceException)                            |
+-------------------+-----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

üßπ Attempting cleanup of known blocking resources...
Cleaning up ECR repository: iac-etl-repo-jr...
‚úÖ ECR repository iac-etl-repo-jr cleaned up.
Deleting Redshift workgroup: iac-workgroup-jr...
Deleting Redshift namespace: iac-namespace-jr...
üîÅ Retrying deletion of iac-phase2 after cleanup...
‚úÖ iac-phase2 stack successfully deleted on retry.

‚ö†Ô∏è  Stack iac-phase1 does not exist. Skipping.

‚ö†Ô∏è  Stack disguise-github-role-stack does not exist. Skipping.

üî• Deleting ECR repository (iac-etl-repo-jr)...
‚ö†Ô∏è  ECR repository iac-etl-repo-jr not found. Skipping.

üî• Deleting GitHub OIDC Identity Provider...
Found OIDC Provider ARN: arn:aws:iam::377983122567:oidc-provider/token.actions.githubusercontent.com. Deleting...
‚úÖ GitHub OIDC Identity Provider deleted.
--------------------------------------------------------
üéâ Full teardown complete. Check teardown_20251006_205646.log for full details.
